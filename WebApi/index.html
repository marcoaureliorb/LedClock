<html>
   <head>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
      <title>Led Clock REST API</title>
   </head>
   <body  onload="startup();">
   
   <div class="container-fluid p-3 bg-primary text-white text-center">
     <h2>Led Clock</h2>
     <p>Welcome to Led Clock REST API</p> 
   </div>
      <p>
	  
<div class="container mt-3">

  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" data-bs-toggle="tab" href="#home">Home</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="tab" href="#config">Config</a>
    </li>
  </ul>
  
<div class="tab-content">
    <div id="home" class="container tab-pane active"><br>
<table class="table table-striped">
    <thead>
      <tr>
        <th>Parameter</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
<tr>
        <td>Time</td>
        <td id="idTime"></td>
		</tr>
<tr>
        <td>Format</td>
        <td id="idFormatTime">12h</td>
		</tr>
<tr>
        <td>Temperature</td>
        <td id="idTemp"></td>
		</tr>		

<tr>
        <td>Brightness sensor map</td>
        <td id="idbsm"></td>
		</tr>
<tr>
        <td>Clock brightness mode</td>
        <td id="idcbm"></td>
		</tr>
<tr>
        <td>Clock hour color</td>
        <td id="idchc"></td>
		</tr>
<tr>
        <td>Clock minute color</td>
        <td id="idcmc"></td>
		</tr>
<tr>
        <td>Deco brightness mode</td>
        <td id="iddbm"></td>
		</tr>
<tr>
        <td>Deco color</td>
        <td id="iddc"></td>
		</tr>
<tr>
        <td>Temperature symbol Color</td>
        <td id="idtsc"></td>
		</tr>
<tr>
        <td>Temperature value color</td>
        <td id="idtvc"></td>
		</tr>
<tr>
        <td>Temperature url</td>
        <td id="idurltemp"></td>	
		</tr>      
    </tbody>
  </table>		
    </div>
    <div id="config" class="container tab-pane fade">
	
	  <br>

	  <h4 class="">Clock</h4>
	  
	  <div class="row">
	   <div class="col-2 ">Color Hour</div>
	   <div class="col-2  "><input type="color" id="clock_first_hour_color" name="favcolor" value="#3A8439">
	                        <input type="color" id="clock_second_hour_color" name="favcolor" value="#3A8439"></div>
	   <div class="col-2  ">Color Minute</div>
	   <div class="col-2  "><input  type="color" id="clock_first_minute_color" name="favcolor" value="#dd0000">
	                        <input  type="color" id="clock_secod_minute_color" name="favcolor" value="#dd0000"></div>
	   <div class="col-4  ">
	   	  <div class="form-check form-switch">
		  		    <label class="" for="">12-hour</label>
	        <label class="form-check-label" for="mySwitch">24-hour</label>
            <input class="form-check-input" type="checkbox" id="mySwitch" name="format" value="yes" checked>


          </div>
	   </div>
	  </div>

	  <br>
	  <h4 class="border-top">Temperature</h4>
	  
	  <div class="row">
	  <div class="col-sm-2 ">Value</div>
	  <div class="col-sm-2  "><input type="color" id="favTVC1" name="favcolor" value="#ffffff"><input type="color" id="favTVC2" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-2  ">Symbol</div>
	  <div class="col-sm-2  "><input type="color" id="favTSC1" name="favcolor" value="#0000ff"><input type="color" id="favTSC2" name="favcolor" value="#0000ff"></div>
	  <div class="col-sm-4  "></div>
	  </div>

	  <br>	
	  <h4 class="border-top">Decoration light</h4>
	  
	  <div class="row">
	  <div class="col-sm-2 ">Line 1</div>
	  <div class="col-sm-1  "><input type="color" id="favDLC1" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC2" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC3" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC4" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC5" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC6" name="favcolor" value="#ffffff"></div>
	  </div>
	  <div class="row">
	  <div class="col-sm-2 ">Line 2</div>
	  <div class="col-sm-1  "><input type="color" id="favDLC7" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC8" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC9" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC10" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC11" name="favcolor" value="#ffffff"></div>
	  <div class="col-sm-1  "><input type="color" id="favDLC12" name="favcolor" value="#ffffff"></div>
	  </div>
	  
	  <br>	
	  <h4 class="border-top">Clock Brightness State</h4>
	  
	  <div class="row">
	  <div class="col-sm-2 ">State</div>
	  <div class="col-sm-10  ">
	     <div class="container mt-3">
           <button type="button" class="btn btn-primary" id="idCBSOn">ON</button>
           <button type="button" class="btn btn-primary" id="idCBSOff">OFF</button>
           <button type="button" class="btn btn-primary" id="idCBSAuto">AUTO</button>	   
        </div>
	  </div>

	  </div>
	  
	  <br>	
	  <h4 class="border-top">Decoration Brightness State</h4>
	  
	  <div class="row">
	  <div class="col-sm-2 ">State</div>
	  <div class="col-sm-10  ">
	  
	    <div class="container mt-3">
           <button type="button" class="btn btn-primary" id="idDBSOn">ON</button>
           <button type="button" class="btn btn-primary" id="idDBSOff">OFF</button>
           <button type="button" class="btn btn-primary" id="idDBSAuto">AUTO</button>
        </div>
				   
	  </div>
	  	  </div>
	  
	  
	  <br>	
	  <h4 class="border-top">Temperature url</h4>
	  
	  <div class="row">
	  <div class="col-sm-2 ">Url</div>
	  <div class="col-sm-9"><input type="tempurl" class="form-control" id="tempurl" placeholder="Enter temperature url" name="tempurl"value="http://api.hgbrasil.com/weather?woeid=455831&format=json-cors&array_limit=2&fields=only_results,temp,city_name&key=3b983af0"></div>
	  <div class="col-sm-1 "><button type="button" class="btn btn-primary">submit</button></div>
	  </div>	  
	  
	  
	  
	  
	  
	  
	  
	  

	 </div>

  </div>  
  
  
  
  
  
</div> 	  


      <script>
		function componentToHex(c) {
		  var hex = c.toString(16);
		  return hex.length == 1 ? "0" + hex : hex;
		}

		function rgbToHex(r, g, b) {
		  return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
		}
	  
         function hexToRgb(hex) {
             var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
             return result ? {
                 r: parseInt(result[1], 16),
                 g: parseInt(result[2], 16),
                 b: parseInt(result[3], 16)
             } : null;
         }
         function cmd(arg) {
             url = "http://192.168.100.7/api.html?cmd=" + arg;
             post(url);
         }
         function changeColor() {
             var d = hexToRgb($("#favcolor").val());
             url = "http://192.168.100.7/api.html?cmd=" + $("#colorFunctions").val() + "&red=" + d.r + "&green=" + d.g + "&blue=" + d.b;
             post(url);
         }
         function changeBrightState(comp) {
             var cmd = $("#clockbrighttype").val();
             var state = $("#brightnessstate").val();
             var value = $("#brightnessstateValue").val();
             url = "http://192.168.100.7/api.html?cmd=" + cmd + "&state=" + state + "&value=" + value;
             post(url);
         }
		 function getinfo(callback){
		     url = "http://192.168.100.7/getinfo";
		     xhttp = new XMLHttpRequest();
			 xhttp.onreadystatechange = function() {
			     if (this.readyState == 4) {
				     if (this.status == 200) {
					     callback(JSON.parse(this.responseText, null, '	'));
				     }
					 if (this.status == 404) {elmnt.innerHTML = "Page not found.";}
				}
			}
			xhttp.open("GET", url, true);
			xhttp.send();
		 }
         function post(url) {
             $.get(url, function(data) {
                 var jsonPretty = JSON.stringify(data, null, '	');
                 $("pre").text(jsonPretty);
             });
         }
		 
		 function setColor(component, valueHex){
		 
			var x = valueHex.replace(')', '').replace('(','').replace('#', '').split(',');
			var cor = rgbToHex(parseInt(x[0]),parseInt(x[1]),parseInt(x[2]));
			document.getElementById(component).value = cor;				
		 }
		 
		function changeBrightState(components, valor){
		
			document.getElementById(components[0]).classList.remove('btn-success');
			document.getElementById(components[1]).classList.remove('btn-success');
			document.getElementById(components[2]).classList.remove('btn-success');
			switch(valor){
				case "0":
					document.getElementById(components[1]).classList.add('btn-success');
					break;
				case "1":
					document.getElementById(components[0]).classList.add('btn-success');
					break;
				case "3":
					document.getElementById(components[2]).classList.add('btn-success');
					break;					   
			}
		}		 
		 
		 function callback(dados){
				document.getElementById('idbsm').innerHTML = dados['Brightness Sensor map'];
				
				document.getElementById('idcbm').innerHTML = dados['Clock_Brightness_Mode'];
				var valor = dados['Clock_Brightness_Mode'][0];
				changeBrightState(['idCBSOn', 'idCBSOff', 'idCBSAuto'], valor);

				document.getElementById('idchc').innerHTML = dados['Clock_First_Hour_Color'];
				setColor('clock_first_hour_color', dados['Clock_First_Hour_Color']);
				setColor('clock_second_hour_color', dados['Clock_Second_Hour_Color']);
				
				document.getElementById('idcmc').innerHTML = dados['Clock_First_Minute_Color'];
				setColor('clock_first_minute_color', dados['Clock_First_Minute_Color']);
				setColor('clock_secod_minute_color', dados['Clock_Secod_Minute_Color']);
				
				document.getElementById('iddbm').innerHTML = dados['Deco_Brightness_Mode'];
				var valor = dados['Deco_Brightness_Mode'][0];
				changeBrightState(['idDBSOn', 'idDBSOff', 'idDBSAuto'], valor);
				
				document.getElementById('iddc').innerHTML = dados['Deco_Color'];
				//setColor('favDLC',dados['Deco_Color']);
				
				document.getElementById('idtsc').innerHTML = dados['Temp_Symbol_Color'];
				//setColor('favTSC1', dados['Temp_Symbol_Color']);
				//setColor('favTSC2', dados['Temp_Symbol_Color']);
				//var x = dados['Temp_Symbol_Color'].replace(')', '').replace('(','').replace('#', '').split(',');
				
				document.getElementById('idtvc').innerHTML = dados['Temp_Value_Color'];
				//setColor('favTVC1', dados['Temp_Value_Color']);
				//setColor('favTVC2', dados['Temp_Value_Color']);
				
				document.getElementById('idTemp').innerHTML = dados['Temperature'];	
				document.getElementById('idTime').innerHTML = dados['Time'];	 
				document.getElementById('idurltemp').innerHTML = dados['Url Temperature'];
			 }		

            function startup(){
		     getinfo(callback);
		 }
 
		 
      </script>
   </body>
</html>